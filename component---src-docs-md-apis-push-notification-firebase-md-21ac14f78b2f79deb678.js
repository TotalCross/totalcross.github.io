(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"+HEo":function(e,t,n){e.exports=n.p+"static/image25-1f4352162517a3a0816cd68ddcfcff49.png"},"78zx":function(e,t,n){e.exports=n.p+"static/sdds-995ac58fa8ca0745b03e4541d7cd3066.png"},D3zK:function(e,t,n){e.exports=n.p+"static/criar-um-projeto-android-7e1dd70cca653433e55fa72ff05b3dc6.png"},RBfh:function(e,t,n){e.exports=n.p+"static/captura-de-tela-86-de9dc22f54d8fe97bd9253bd289a4204.png"},"b+Vz":function(e,t,n){e.exports=n.p+"static/registrar-app-424b1b453870bf1088f586851af690ad.png"},g46y:function(e,t,n){e.exports=n.p+"static/captura-de-tela-80-1-3fa391db89c06843f36ed890ffdee293.png"},hi6j:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return s})),n.d(t,"default",(function(){return l}));n("91GP"),n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("FlsD"),n("q1tI");var i=n("7ljp"),a=n("hhGP");n("qKvR");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var s={};void 0!==s&&s&&s===Object(s)&&Object.isExtensible(s)&&!s.hasOwnProperty("__filemeta")&&Object.defineProperty(s,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/docs/md/apis/push-notification-firebase.md"}});var r={_frontmatter:s},c=a.a;function l(e){var t=e.components,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["components"]);return Object(i.b)(c,o({},r,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"push-notification-firebase"},"Push Notification Firebase"),Object(i.b)("p",null,"We can judge as notifications as and in some cases with the same irritant. But even so, dates remain one of the most efficient ways to interact with your users and ensure their return to your application."),Object(i.b)("p",null,"You can use Firebase as a basis to send a notification to the user of your mobile application."),Object(i.b)("h2",{id:"what-is-firebase"},"What is Firebase?"),Object(i.b)("p",null,Object(i.b)("a",o({parentName:"p"},{href:"https://firebase.google.com/?gclid=Cj0KCQjw4fHkBRDcARIsACV58_GiXRpyAtn5fhmrMzOek0nBNHGtA9H2KEFg05N8C_qKtm2aPU34FGQaAqrsEALw_wcB"}),"Firebase")," is a platform that offers several services for both mobile and web applications. With this technology, you can incrementally add to your app several functions in a simple and fast way."),Object(i.b)("p",null,"When it comes to notification, TotalCross uses the service called ",Object(i.b)("strong",{parentName:"p"},"Cloud Messaging"),"."),Object(i.b)("p",null,Object(i.b)("a",o({parentName:"p"},{href:"https://firebase.google.com/docs/cloud-messaging/?hl=en-us"}),"Firebase Cloud Messaging ","(","FCM",")")," is a message solution between platforms, allowing you to send notifications reliably and cost-effectively."),Object(i.b)("p",null,"Until now, there were no binding to get the Firebase Identitity Token, but ",Object(i.b)("strong",{parentName:"p"},"as of TotalCross 3.43 for Android")," and ",Object(i.b)("strong",{parentName:"p"},"TotalCross 4.1.0 for iOS"),", we finally finish these binds!"),Object(i.b)("h2",{id:"configuring-the-environment"},"Configuring the Environment"),Object(i.b)("h3",{id:"creating-a-totalcross-project"},"Creating a TotalCross Project."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Create a ",Object(i.b)("strong",{parentName:"li"},"Maven project")," called ",Object(i.b)("strong",{parentName:"li"},"PushNotification_Firebase")," and configure pom.xml to use TotalCross.")),Object(i.b)("p",null,"If you ",Object(i.b)("strong",{parentName:"p"},"don't know")," how to create and configure a Maven project, log in below:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Create a package called ",Object(i.b)("strong",{parentName:"li"},"pushnotification_firebase"),", and then create a class with the same name. This class will be our ",Object(i.b)("strong",{parentName:"li"},"MainWindow"),".")),Object(i.b)("p",null,Object(i.b)("img",{alt:"image122",src:n("oXiD")})),Object(i.b)("p",null,"Within the PushNotification_Firebase, create a ",Object(i.b)("strong",{parentName:"p"},"static String")," named ",Object(i.b)("strong",{parentName:"p"},"firebaseToken"),". And within the method, we will use the command ",Object(i.b)("inlineCode",{parentName:"p"},"FirebaseInstanceId.getInstance().GetToken();")," to get the token. In addition, we'll add a message to be printed on the console to show the token. In the end, it will look like this:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-java"}),'public static String firebaseToken;\n\n    public PushNotification_Firebase() {\n        firebaseToken = FirebaseInstanceId.getInstance().getToken();\n        System.out.println("FIREBASE TOKEN: " + firebaseToken);\n    }\n')),Object(i.b)("p",null,"This token is needed to send a unicast message to a single device, or to identify that device so that we can create a group to send messages. So let's start with the basics and then go toward the identification of a single device to send a custom message for it."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Okay, done that, let's create a static block to set the application ID of your application through the ",Object(i.b)("inlineCode",{parentName:"li"},"applicationID")," attribute. In android this is called ",Object(i.b)("strong",{parentName:"li"},"APP Bundle"),". With this, our PushNotification_Firebase class will look like this:")),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-java"}),'public class PushNotification_Firebase extends MainWindow {\n    public static String firebaseToken;\n\n    public PushNotification_Firebase() {\n        firebaseToken = FirebaseInstanceId.getInstance().getToken();\n        System.out.println("FIREBASE TOKEN: " + firebaseToken);\n    }\n\n    static{\n        Settings.applicationId = "TCFB";\n    }\n}\n')),Object(i.b)("p",null,'{% hint style="warning" %}\nthe chosen Id must always be a string with 4 letters. This id is very important because the name of our Android project should be totalcross.app . Do not worry, let\'s get better at the next step!'),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Finally, check if your project has a folder named ",Object(i.b)("strong",{parentName:"li"},"target"),", otherwise, create a folder named target in the same location as the pom.xml, src, and .settings file.")),Object(i.b)("p",null,Object(i.b)("img",{alt:"image25",src:n("+HEo")})),Object(i.b)("h3",{id:"creating-a-firebase-project"},"Creating a Firebase project"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Go to ",Object(i.b)("a",o({parentName:"li"},{href:"https://firebase.google.com/"}),"Firebase"),' website and click "Go to Console," and then click "Create New Project." Let\'s call it "Push Notification"')),Object(i.b)("p",null,Object(i.b)("img",{alt:"captura80-1",src:n("g46y")})),Object(i.b)("p",null,'Then you can click on "Create project" and then "Continue".'),Object(i.b)("p",null,"You will be redirected to an overview of your project, where you will click on the Android icon that is in the banner of the page, as shown in the image below:"),Object(i.b)("p",null,Object(i.b)("img",{alt:"como criar um projeto android",src:n("D3zK")})),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"A form will appear for you to fill out. In the first step, Register App, you only need to fill in the name of the Android package. Here you must fill in with ",Object(i.b)("strong",{parentName:"li"},"totalcross.app","<","Settings.applicationID",">")," that you filled in the previous step. In this case, it will be called ",Object(i.b)("strong",{parentName:"li"},"totalcross.appTCFB"),". You can then click Register App.")),Object(i.b)("p",null,Object(i.b)("img",{alt:"registrar-app",src:n("b+Vz")})),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"The second step is quite simple, just click to download the file ",Object(i.b)("strong",{parentName:"li"},"google-services.json")," and then copy the file and paste inside the ",Object(i.b)("strong",{parentName:"li"},"target")," folder, within your project and then click ",Object(i.b)("strong",{parentName:"li"},"next"),".")),Object(i.b)("p",null,"If you are deploying to Android and TotalCross can't find google-servoces.json, it will tell you that Firebase won't work with this message:"),Object(i.b)("p",null,"\"Could not find 'google-services.json', thus Firebase will be ignored further on\""),Object(i.b)("p",null,Object(i.b)("img",{alt:"captura-de-tela-86",src:n("RBfh")})),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Step 3 is just to Gradle, so we can ",Object(i.b)("strong",{parentName:"li"},"click next")),Object(i.b)("li",{parentName:"ul"},'Step 4 will only be possible when we test, so we can click the "',Object(i.b)("strong",{parentName:"li"},"Skip step"),'" option.')),Object(i.b)("h2",{id:"implementation"},"Implementation"),Object(i.b)("p",null,"Now, with the environment set up, we can go back to our ",Object(i.b)("inlineCode",{parentName:"p"},"MainWindow"),", the PushNotification_Firebase. Inside it, let's create two more methods: ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("inlineCode",{parentName:"strong"},"onTokenRefresh()"))," and ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("inlineCode",{parentName:"strong"},"onMessageReceived()")),"."),Object(i.b)("h3",{id:"receiving-token"},"Receiving Token"),Object(i.b)("p",null,"It is through ",Object(i.b)("strong",{parentName:"p"},"onTokenRefresh","(",")")," that you will be able to receive the Token to later save and associate with a user. Check out the example below:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-java"}),'protected FirebaseInstanceIdService initFirebaseInstanceIdService() {\n    return new FirebaseInstanceIdService() {\n        @Override\n        public void onTokenRefresh() {\n            firebaseToken = FirebaseInstanceId.getInstance().getToken();\n            System.out.println("Token refresh");\n        }\n    };\n}\n')),Object(i.b)("h3",{id:"receiving-notification"},"Receiving Notification"),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"onMessageReceived()")," method fires every time the APP receives a notification, so to be more illustrative when testing, we will use this method to print to the console which notification was sent. Just copy the code below"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-java"}),'    protected FirebaseMessagingService initFirebaseMessagingService() {\n        return new FirebaseMessagingService() {\n            @Override\n            public void onMessageReceived(RemoteMessage remoteMessage) {\n                Vm.debug("I was called");\n                System.out.println((String)remoteMessage.getData().get("hello"));\n            }\n        };\n    }\n')),Object(i.b)("h3",{id:"reviewing-pushnotification_firebase-class-extends-mainwindow"},"Reviewing PushNotification_Firebase class ","(","extends MainWindow",")"),Object(i.b)("p",null,"And finally, your main class must to be as follows:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-java"}),'package pushnotification_firebase;\n\nimport totalcross.firebase.FirebaseMessagingService;\nimport totalcross.firebase.RemoteMessage;\nimport totalcross.firebase.iid.FirebaseInstanceId;\nimport totalcross.firebase.iid.FirebaseInstanceIdService;\nimport totalcross.sys.Settings;\nimport totalcross.sys.Vm;\nimport totalcross.ui.MainWindow;\n\npublic class PushNotification_Firebase extends MainWindow {\n    public static String firebaseToken;\n\n    public PushNotification_Firebase() {\n        firebaseToken = FirebaseInstanceId.getInstance().getToken();\n        System.out.println("FIREBASE TOKEN: " + firebaseToken);\n    }\n\n    static{\n        Settings.applicationId = "TCFB";\n        Settings.iosCFBundleIdentifier = "totalcross.appABCD";\n    }\n\n    @Override\n    protected FirebaseInstanceIdService initFirebaseInstanceIdService() {\n        return new FirebaseInstanceIdService() {\n            @Override\n            public void onTokenRefresh() {\n                firebaseToken = FirebaseInstanceId.getInstance().getToken();\n                System.out.println("Token refresh");\n            }\n        };\n    }\n\n    @Override\n    protected FirebaseMessagingService initFirebaseMessagingService() {\n        return new FirebaseMessagingService() {\n            @Override\n            public void onMessageReceived(RemoteMessage remoteMessage) {\n                Vm.debug("I was called");\n                System.out.println((String) remoteMessage.getData().get("hello"));\n            }\n        };\n    }\n}\n')),Object(i.b)("p",null,"You are ready to send a first message. The ideal is always first, so keep learning how to submit an application!."),Object(i.b)("h2",{id:"test"},"Test"),Object(i.b)("p",null,Object(i.b)("img",{alt:"sdds",src:n("78zx")})),Object(i.b)("h2",{id:"references"},"References"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"You can check the complete example in the ",Object(i.b)("a",o({parentName:"li"},{href:"https://github.com/TotalCross/PushNotification_Firebase"}),"GitHub"),"."),Object(i.b)("li",{parentName:"ul"},"It is also possible to send internal notifications from your app to users. To better understand how this is possible, access the notification session ","(","link below",")",".")))}void 0!==l&&l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/docs/md/apis/push-notification-firebase.md"}}),l.isMDXComponent=!0},oXiD:function(e,t,n){e.exports=n.p+"static/image122-c6b1b1f6647af3184b2d35933308a3b0.png"}}]);
//# sourceMappingURL=component---src-docs-md-apis-push-notification-firebase-md-21ac14f78b2f79deb678.js.map